<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>400</depth>
  <persistent>0</persistent>
  <parentName>obj_ctrl_stage</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>// \/\/ STEP-BASED TIMELINE VARIABLES \/\/
stage_time = 0;
completedelay = 0; 
global.omake_enabled = 0;
global.level = 3; // used for game completion/object deletion checking

// \/\/ BACKGROUND INITIALISATION/LOADING \/\/
trans_alpha = 0;
start = 3500;
finish = start+1400;

scr_camera_init(320,0,0,0,0);

global.behaviour = 4; // determines behaviour of stars (if used)
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/**********************STAGE COMPLETE HANDLING*************************/
if stage_time &gt; 12000 
&amp;&amp; !instance_exists(obj_boss3)
//&amp;&amp; !instance_exists(obj_boss3_dead)
&amp;&amp; !instance_exists(obj_boss3_omake)
&amp;&amp; !instance_exists(obj_fade)
then completedelay += 1;
if completedelay = 120
    {
    with obj_rain instance_destroy();
    with obj_cloud instance_destroy();
    with obj_light_gen instance_destroy();
    instance_create(x,y,obj_ctrl_clear);
    }

/**********************STAGE TIMELINE HANDLING*************************/
/*
This is the code that controls what happens in the stage, whether it be
enemies, background effects, timing of music or boss initialisation.
*/

stage_time += 1;
switch stage_time
    {
    case 120:
        {
        instance_create(160,-64,obj_en_carrier);
        break;
        }
    case 220:
        {
        instance_create(100,-32,obj_en5b);
        instance_create(220,-32,obj_en5b);
        break;
        }
    case 380:
        {
        e1=instance_create(80,-64,obj_en7);
        e1.direction = 280;
        e2=instance_create(240,-64,obj_en7);
        e2.direction = 260;
        //instance_create(xview,yview,obj_warning);
        break;
        }
    case 750:
        {
        e=instance_create(160,-200,obj_en_cruiser);
        e.p[4,2] = obj_en_tur2;
        e.p[5,2] = obj_en_tur2;
        e.spawner_en[3] = obj_en4;
        break;
        }
    case 2200:
        {
        e=instance_create(395,-100,obj_en_cruiser);
        e.hscroll=1;
        break;
        }
        
    case 4800:
        {
        scr_fademusic(global.music_volume,0.005);
        break;
        }
    case 5000:
        {
        instance_create(xview,yview,obj_warning); // different warning type
        break;
        }
    case 5350:
        {
        instance_create(160,-240,obj_boss3);
        with obj_ctrl_music event_user(2); // boss music
        break;
        }
    }
    
/* --- BACKGROUND STUFF --- */    
    
/* STAGE 3 SPACE PHASE */
if stage_time &gt; 2200 &amp;&amp; stage_time &lt; 2400
    {
    if background_hspeed[0] &gt; -1 then background_hspeed[0] -= 0.01;
    }
if stage_time &gt; 2400 &amp;&amp; stage_time &lt; 2600
    {
    if background_hspeed[0] &lt; 0 then background_hspeed[0] += 0.01;
    }
    
/* STAGE 3 CLOUD PHASE */
// slow down to over planet Earth
if stage_time = start then instance_create(160,yview-160,obj_planet3);
if stage_time &gt; start &amp;&amp; stage_time &lt; start+200
    {
    if background_vspeed[0] &gt; 0 then background_vspeed[0] -= 0.015;
    }
    
if stage_time &gt; start+200 &amp;&amp; stage_time &lt; start+900
    {
    // do some zoom code here of earth, followed by a fade to color
    with obj_planet3
        {
        image_xscale += 0.002;
        image_yscale += 0.002;
        }
        
    if stage_time &gt; start+400
        {
        if trans_alpha &lt; 1 then trans_alpha += 0.002;
        }
    }
    
if stage_time = start+900
    {
    with obj_planet3 instance_destroy();
    
    // set up cloud layers, init lightning bkg code
    instance_create(0,0,obj_light_gen);
    background_index[1] = bkg_cloud;
    background_visible[1] = 1;
    background_alpha[1] = 0;
    background_x[1] = 40;
    background_vspeed[1] = 1;
    
    instance_create(32,-48,obj_cloud);
    instance_create(128,352,obj_cloud);
    instance_create(288,160,obj_cloud);
    
    repeat 15
        {
        xx = random(320);
        yy = random(320);
        dd = random_range(260,280);
        ss = random_range(7,12);
        ra = scr_basicshot(xx,yy,obj_rain,ss,dd);
        ra.depth = random_range(0,1500);
        ra.image_alpha = 0;
        }
    }
if stage_time &gt; start+900 &amp;&amp; stage_time &lt; finish
    {
    // fade out from colour
    if trans_alpha &gt; 0 then trans_alpha -= 0.0025;
    if background_alpha[1] &lt; 1 then background_alpha[1] += 0.005;
    with obj_rain {if image_alpha &lt; 1 then image_alpha += 0.005};
    }
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if trans_alpha &lt;= 0 exit;
draw_sprite_ext(spr_bluepixel,0,0,0,320,320,0,c_white,trans_alpha);
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
