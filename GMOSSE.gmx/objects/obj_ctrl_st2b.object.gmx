<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-1</depth>
  <persistent>0</persistent>
  <parentName>obj_ctrl_stage</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/**********************STAGE COMPLETE HANDLING*************************/
if stage_time &gt; 8500 
&amp;&amp; !instance_exists(obj_boss2)
&amp;&amp; !instance_exists(obj_boss2_dead)
&amp;&amp; !instance_exists(obj_boss2_omake)
&amp;&amp; !instance_exists(obj_fade)
then completedelay += 1;

if completedelay = 120 then instance_create(x,y,obj_ctrl_clear);

/*****************OBJECT SCROLLING/SPAWN HANDLING**********************/
/*
This is here because the room is larger than the view on the screen,
and as such the view scrolls upwards. The last thing we need is for
the player ship to retain its original position and appear to just
go under and out of the screen. Same thing with bullets and enemies
(unless the enemies are designed to do that, of course).
*/
if yview &lt;= 3000 &amp;&amp; spd_y &lt; -1
    {
    scr_scrollspd(0,-1);
    background_vspeed[0] = -0.99 * -spd_y;
    background_vspeed[1] = -0.99 * -spd_y;
    }
if yview &lt;= 680 &amp;&amp; spd_y &lt; -0.5
    {
    scr_scrollspd(0,-0.5);
    background_vspeed[0] = -0.99 * -spd_y;
    background_vspeed[1] = -0.99 * -spd_y;
    }
if yview &lt; 1
    {
    scr_scrollspd(0,0);
    background_vspeed[0] = 0.09;
    background_vspeed[1] = 0.09;
    }
    
/* 
Now with that being said we also don't want enemies off-screen to remain
as resource hogs, so for stuff like walls they all get deactivated in
the Room Creation code event (located in rm_stage2 &gt; Settings tab).
This line of code reactivates anything that is deactivated and is
entering our view.
*/
instance_deactivate_object(obj_en_parent);
instance_deactivate_object(obj_en_wall);
instance_activate_region(-48,yview-48,368,368,true);

/**********************STAGE TIMELINE HANDLING*************************/
/*
This is the code that controls what happens in the stage, whether it be
enemies, background effects, timing of music or boss initialisation.
*/

stage_time += 1;
switch stage_time
    {
    case 6000:
        {
        scr_fademusic(global.music_volume,0.005);
        break;
        }
    case 6200:
        {
        instance_create(xview,yview,obj_warning);
        break;
        }
    case 6550:
        {
        with obj_ctrl_music event_user(1); // boss music
        break;
        }
    }

// **********************STAGE TIMELINE HANDLING*************************
/*stage_time += 1;
switch stage_time
    {
    case 340:
        {
        instance_create(160,-96,obj_boss2);
        break;
        }
    }
    
// Spawn walls on the sides
if instance_exists(wall) then 
if wall.y &gt;= yview+16 &amp;&amp; completedelay &lt; 60
    {
    wall = instance_create(16,yview-16,obj_wall);
    wall.vspeed = global.bkg_scrollspeed;
    wall2 = instance_create(320-16,yview-16,obj_wall);
    wall2.vspeed = global.bkg_scrollspeed;
    }
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>// \/\/ STEP-BASED TIMELINE VARIABLES \/\/
stage_time = 5800; // step-based timeline variable
fade = global.music_volume; // used for fade out of music within step-based timeline

// stage complete handling
completedelay = 0; 
global.omake_enabled = 1;

// \/\/ BACKGROUND INITIALISATION/LOADING \/\/
/*background_index[2] = global.bkg_stage2;
background_vspeed[2] = 0;
background_visible[2] = 1;
background_htiled[2]=1;
background_vtiled[2]=1;*/

//background_index[1] = global.bkg_planet2;
background_vspeed[1] = -0.99 * -spd_y;
//background_visible[1] = 1;
//background_x[1] = 85; // was 75.5
background_y[1] = room_height - 320;
//background_htiled[1]=0;
//background_vtiled[1]=0;

//background_index[0] = global.bkg_space;
background_vspeed[0] = -0.99 * -spd_y;
//background_visible[0] = 1;
//background_vtiled[0] = 1;

// \/\/ MISC. GLOBAL/TIMELINE VARIABLES \/\/
global.level = -2; // informs what stage this is (used for game completion/object deletion checking)
global.behaviour = 4; // determines behaviour of stars (if used)

// \/ Starts the room with walls on the sides
/*for (i=320; i&gt;-16; i-=32)
    {
    wall = instance_create(16,i,obj_wall);
    wall.vspeed = global.bkg_scrollspeed;
    wall2 = instance_create(304,i,obj_wall);
    wall2.vspeed = global.bkg_scrollspeed;
    }
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
