<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_beam_hitbox</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-6</depth>
  <persistent>0</persistent>
  <parentName>obj_bullettarget</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>// todo: replace parent with obj_lasertarget or something similar
event_inherited();

// configurable variables
b_img = spr_beam;          // the beam itself
f_img = spr_beam_flash;    // the beginning of the beam
h_img = spr_beam_head2;      // the end of the beam
b_spd = 8;
direction = 270;
image_xscale = 0;
image_angle = direction;

// image control vars, don't touch these
b_subimg = 0; b_alpha = 1;
f_subimg = 0; f_alpha = 1;
h_subimg = 0; h_alpha = 1;
b_subimg_max = sprite_get_number(b_img)-1;
f_subimg_max = sprite_get_number(f_img)-1;
h_subimg_max = sprite_get_number(h_img)-1;
b_width = sprite_get_width(b_img);
h_width = sprite_get_xoffset(h_img);

surf = -1;
event_user(0);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="1" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>surface_free(surf);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if b_alpha &gt; 0.05
    {
    b_alpha -= 0.05;
    h_alpha -= 0.05;
    }
else
    {
    if f_alpha &gt; 0.05 then f_alpha -= 0.05 else instance_destroy();
    }
alarm[0] = 1;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>image_angle = direction;
if image_xscale &lt; 320 then image_xscale += b_spd
else 
    {
    direction += 0.5;
    if alarm[0] = -1 then alarm[0] = 30;
    }
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="10">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Update laser beam surface
var s,h;
s = floor(b_subimg);
h = sprite_get_height(b_img);

if !surface_exists(surf) then surf = surface_create(320,h);
surface_set_target(surf);
draw_clear_alpha(c_white,0);
for (i=0;i&lt;320;i+=b_width)
    {
    draw_sprite(b_img,s,i,h/2);
    s += 1; if s &gt; b_subimg_max then s = 0;
    }
surface_reset_target();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>// debug line
//draw_self();

// laser draw stack
if image_xscale &lt; 1 then exit;

if b_subimg = round(b_subimg) then event_user(0);
if surface_exists(surf)
    {
    var xx,yy;
    xx = x + lengthdir_x(8,image_angle+90);
    yy = y + lengthdir_y(8,image_angle+90);
    draw_surface_general(surf,0,0,image_xscale,16,xx,yy,1,1,image_angle,image_blend,image_blend,image_blend,image_blend,b_alpha);
    }
else event_user(0);

// laser head (end of laser)
var hl,hx,hy;
hl = image_xscale;
hx = x + lengthdir_x(hl, image_angle);
hy = y + lengthdir_y(hl, image_angle);
draw_sprite_ext(h_img,h_subimg,hx,hy,1,1,image_angle,image_blend,h_alpha);

// laser flash (start of laser)
if sprite_exists(f_img) then draw_sprite_ext(f_img,f_subimg,x,y,1,1,0,image_blend,f_alpha);

// Image indexes
b_subimg += 0.25; if b_subimg &gt; b_subimg_max then b_subimg = 0; // beam
h_subimg += 0.25; if h_subimg &gt; h_subimg_max then h_subimg = 0; // head
f_subimg += 0.25; if f_subimg &gt; f_subimg_max then f_subimg = 2; // flash
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
